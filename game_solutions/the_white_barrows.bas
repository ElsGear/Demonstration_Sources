10  REM**CONSULT TEXT FOR MAP
    11ONERRORRUN
    13*FX200,3
    15*TV255
    17MODE7
    20 B=0
    25J%=RND(-TIME)
    30 N=42:@%=&00000303
    40 DIM AA(N),BB(3)
    50VDU26:CLS:FOR I%=0TO24:PRINTCHR$132;CHR$157;CHR$135:NEXT
    52VDU23,0,11,0,0,0,0,0,0,0
    55PRINTTAB(10,11);CHR$141;CHR$136;"THE WHITE BARROWS"'TAB(10,12);CHR$141;CHR$136;"THE WHITE BARROWS"
    56FOR W%=0TO30000:NEXT
    57*FX15,0
    60GOSUB1830
    70GOSUB1780
    80GOSUB1740
    90FOR X=1 TO 9
   100GOSUB1710
   110NEXT X
   120FOR I=1 TO 3
   130 X=10:GOSUB1710
   140 X=11:GOSUB1710
   150NEXT I
   160 X=0:GOSUB1710:Y=R%
   170GOSUB1710:C=R%
   175*FX200,2  
   180M=500:L=0:R=0:J%=RND(-TIME)
   185PROCwindow1:PROCwindow3
   190 W=0:K=0:GOSUB1470
   200Z$=CHR$130+CHR$157+CHR$135
   201PRINT
   202PRINT;Z$;"CHOICE    ";SPC(3);"C - create a wall"
   204PRINT;Z$;"OF       ";SPC(4);"M - move  S - see plan"
   210PRINT;Z$;"ACTION    ";SPC(3);"V - view a chamber";
   211*FX15,0
   212Q$=GET$
   220IF Q$="V" THEN GOSUB1310:GOTO260
   230IF Q$="C" THEN GOSUB1160:GOTO260
   240IF Q$="M" THEN GOSUB680:GOTO260
   245IF Q$="S" THEN PROCplan:VDU26:PROCwindow1:PROCwindow3:GOTO260
   250PRINTCHR$11:GOTO210
   260  IF AA(Y)=0 OR K=1 OR AA(Y)=10 OR  AA(Y)=11 THEN  GOTO 300
   270  PRINT " THE";:Z=Y:GOSUB 560
   280  PRINT " SUDDENLY ATTACKED !":PRINT
   290  GOTO420
   300  IF M>0 THENGOTO340
   310  PRINT " YOUR STAFF IS NOW USELESS AND"
   320  PRINT " THE EVIL FORCE ATTACKS !"
   330  GOTO420
   340  IF W=0 THENGOTO190
   350  PRINT " CONGRATULATIONS YOU HAVE"
   360  PRINT " DEFEATED THE EVIL SORCERER !"
   370  PRINT " WOULD YOU LIKE TO TRAP ANOTHER"
   375  *FX15,0
   380  INPUT " SORCERER ",Q$
   390  Q$=LEFT$(Q$,1)
   400  IF Q$="Y" THEN GOTO 50
   410  GOTO 510 
   420  PRINT'" OH DEAR, YOU APPEAR TO BE DEAD"
   430  PRINT " WOULD YOU LIKE TO BE"
   435  *FX15,0
   440  INPUT " REINCARNATED ",Q$
   450  Q$=LEFT$(Q$,1)
   460  IF Q$="N" THEN GOTO 510
   470  INPUT " THE SAME SORCERER ",Q$
   480  Q$=LEFT$(Q$,1)
   490  IF Q$="Y" THEN GOTO 180
   500  GOTO 50  
   510  CALL!-4
   520  M=M-R    
   525PROCwindow1
   545PROCwindow3
   550  RETURN      
   560 ON AA(Z) GOTO 570,580,590,600,610,620,630,640,650,660,670
   570  PRINTCHR$129;"RED";CHR$135;"DRAGON":S=30:RETURN
   580  PRINTCHR$130;"GREEN";CHR$135;"DRAGON":S=25:RETURN
   590  PRINTCHR$131;"YELLOW";CHR$135;"DRAGON":S=20:RETURN
   600  PRINTCHR$134;"PLATINUM";CHR$135;"SERPENT":S=28:RETURN
   610  PRINTCHR$131;"GOLD";CHR$135;"SERPENT":S=23:RETURN
   620  PRINTCHR$136;"SILVER";CHR$137;"SERPENT":S=18:RETURN
   630  PRINT " DWARF WITH A SABRE":S=24:RETURN
   640  PRINT " DWARF WITH A SWORD":S=19:RETURN
   650  PRINT " DWARF WITH A KNIFE":S=14:RETURN
   660  PRINT " FRIENDLY GNOME":RETURN
   670  PRINT " MAGIC SPOT"':RETURN
   680  INPUT '" Which chamber do you wish to"'" move to "P
   690  F=0:PRINT
   700  FOR I=0 TO 3   
   710  IF BB(I)=P THEN F=1    
   720  NEXT I   
   730  IF P=0 OR F=0 THEN GOSUB 1470:GOTO 680
   740  IF C<>P THEN GOTO 860
   750  W=1:F=0  
   760  FOR I=0 TO 3   
   770  T=ASC(MID$(A$,C*4-4+I+1,1))-48 
   780  IF T=0 OR T=Y OR AA(T)=10 OR T=L THEN GOTO 810  
   790  IF W=1 OR RND(1)<.5 THEN C=T
   800  W=0:IF AA(T)=11 THEN F=1 
   810  NEXT I    
   820  IF W=1 THEN RETURN   
   830  IF F=0 THEN PRINT " THE SORCERER HAS RUN OFF !":GOTO 860
   840  PRINT " THE SORCERER TROD ON THE MAGIC"
   850  PRINT " SPOT !":X=0:GOSUB 1710:C=R%:GOTO 740
   860  Y=P:IF AA(P)=0 THEN RETURN 
   870  IF AA(P)<>11 THEN 910 
   880  PRINT " POWWW! YOU HAVE JUST TRODDEN ON"
   890  PRINT " THE MAGIC SPOT!":PRINT
   900  X=0:GOSUB 1710:Y=R%:RETURN
   910  IF AA(P)<>10 THEN GOTO 990
   920  R=RND(20)+19
   930  PRINTCHR$134; "THE GOBLIN WILL TELL YOU WHERE"
   940  PRINTCHR$134; "THE SORCERER IS FOR ";R;" GOLD"
   950PRINTCHR$134;"COINS. AGREED? ":Q$=GET$
   960  Q$=LEFT$(Q$,1)
   970  IF Q$<>"Y" THEN RETURN
   980  PRINT'CHR$136; "THE SORCERER IS IN CHAMBER ";C;"."':GOTO 1140
   990K=0:Z=Y:PRINT" A";:GOSUB 560:PRINT " IS ABOUT TO ATTACK !"
  1000  PRINT'CHR$131;"YOU HAVE THREE CHOICES:":PRINT
  1010  PRINTCHR$131;"1 - STUN IT."
  1020  PRINTCHR$131;"2 - TRANSPORT IT."
  1030  PRINTCHR$131;"3 - DESTROY IT.":PRINT
  1040  INPUT " Your choice ",P
  1050  IF P<1 OR P>3 THEN GOTO 1040 
  1060  INPUT " Amount of magic? ",R
  1070  IF R<0 OR R>M THEN GOTO 1060
  1080CLS:PRINTTAB(0,13);:PRINT" THE";:GOSUB560:PRINT" IS ";:B=0
  1090  IF P=1 AND R>S+(RND(2*S/3)-S/3-1)THEN PRINT "STUNNED !":K=1:GOTO1140
  1100  IF P<>2 OR R<S*2+RND(2*S)-S THEN  GOTO 1120  
  1110  PRINT "TRANSPORTED":X=AA(Y):AA(Y)=0:GOSUB 1710:GOTO1140
  1120  IF P=3 AND R>S*4+RND(2*S)-S THEN PRINT "DESTROYED !"':AA(Y)=0:GOTO1140
  1130  IF K=0 AND AA(Y)<>0 THEN PRINT "DAZED !":B=RND(8)-1
  1140  GOSUB 520:IF B>2 AND M>0 THEN GOTO 1000
  1150  RETURN  
  1160  PRINT'" Which chamber do you wish to"
  1170  INPUT " create the magic wall in ",L
  1180  PRINT
  1190  IF L<1 OR L>N THEN GOSUB 1470:GOTO 1160
  1200  IF AA(L)<>0 THEN GOTO 1240 
  1210  PRINT " The magic wall now exists in"
  1220  PRINT " Chamber ";L
  1230  GOTO 1270      
  1240  PRINTCHR$136;"ZAAPPPP !";CHR$137;"CHAMBER ";L;" ALREADY":L=0
  1250  PRINT " CONTAINS MAGIC, THE WALL HAS"
  1260  PRINTCHR$136;"FAILED !"
  1270  PRINT
  1280  R=RND(20)-1+20
  1290  GOSUB 520   
  1300  RETURN      
  1310  PRINT'" Which chamber do you wish to"
  1320  INPUT" view ",P
  1330  F=0    
  1340  FOR I=0 TO 3  
  1350  IF P=BB(I) THEN F=1
  1360  NEXT I     
  1370  IF P=0 OR F=0 THEN PRINT'" CHAMBER MUST BE CONNECTED TO YOURS":GOTO 1310
  1380  PRINT
  1390  IF P=C THEN PRINTCHR$141;CHR$130;SPC(5);"YOU HAVE FOUND THE SORCERER !"'CHR$141;CHR$130;SPC(5);"YOU HAVE FOUND THE SORCERER !"
  1400IF AA(P)=0 THEN PRINTCHR$131"Chamber";CHR$136;P;CHR$137;"is EMPTY!":GOTO1440
  1410  PRINT" THERE IS A";
  1420  Z=P:GOSUB 560 
  1430  PRINT "IN CHAMBER ";P;".";
  1440  R=RND(20)+9
  1450  GOSUB 520  
  1460  RETURN  
  1470  F=0:Q$="1234" 
  1480  FOR I=0 TO 3
  1490  BB(I)=ASC(MID$(A$,Y*4-4+I+1,1))-48 
  1500  F=F+AA(BB(I))-(100*ABS(BB(I)=C))
  1510  NEXT I   
  1520  IF F=0 THEN GOTO 1640 
  1530PRINTCHR$141;CHR$136;CHR$129;SPC(12);"WARNING!"'CHR$141;CHR$136;CHR$129;SPC(12);"WARNING!"
  1540IF F<0 THEN PRINTCHR$131;"THE CHALICE IS NEAR !"
  1550  FOR I=0 TO 3  
  1560  R%=RND(4):IF MID$(Q$,R%,1)=" " THEN GOTO 1560
  1570  Q$=LEFT$(Q$,R%-1)+" "+RIGHT$(Q$,4-R%):T=AA(BB(R%-1))
  1580IF T>0 AND T<4 THEN PRINTCHR$131;"I CAN HEAR A DRAGON !"
  1590IF T>3 AND T<7 THEN PRINTCHR$131;"I CAN HEAR A SERPENT HISSING !"
  1600IF T>6 AND T<11 THEN PRINTCHR$131;"I CAN HEAR MONEY RATTLING !"
  1610IF T=11 THEN PRINTCHR$131;"I CAN FEEL MAGIC VERY CLOSE !"
  1620  NEXT I  
  1630REM
  1640PROCwindow2
  1695PROCwindow3
  1700  RETURN   
  1710  R%=RND(42):IF AA(R%)>0 GOTO 1710
  1720  AA(R%)=X
  1730  RETURN   
  1740  FOR I=0 TO 42 
  1750  AA(I)=0  
  1760  NEXT I  
  1770  RETURN    
  1780  A$="23401567189:1;<=2>?@2ABC2DEF3GHI3JKL3MNO4PQR4STU"
  1790  A$=A$+"4VWX5@X05Y005>A06@C06Y006AD07CF07Y007DG08FI08Y00"
  1800  A$=A$+"8GJ09IK09JL09KM0:LO0:Z00:MP0;OR0;Z00;PS0<RU0<Z00"
  1810  A$=A$+"<SV0=UX0=Z00=>V0?BEHNQTW"
  1820  RETURN 
  1830CLS:FOR W%=0TO24:PRINTCHR$134;CHR$157;CHR$132:NEXT
  1835VDU23,0,11,0,0,0,0,0,0,0
  1840PRINTTAB(3,3);"Your mission is to trap the"'TAB(3,4);"EVIL SORCERER and return the MAGIC"
  1850PRINTTAB(3,5);"CHALICE."'
  1860PRINTTAB(3,7);"You have been given a MAGIC STAFF"
  1870PRINTTAB(3,8);"with 500 units of magic. Use it to"
  1880PRINTTAB(3,9);"overcome the hazards in "''''
  1890PRINTTAB(10,14);CHR$136;"THE WHITE BARROWS"
  1900PRINTTAB(8,22)"PRESS ANY KEY TO BEGIN"
  1905ZZ=GET:CLS:VDU23,0,11,255,0,0,0,0,0,0
  1910RETURN
  2000DEF PROCwindow1
  2002V%=VPOS
  2005VDU28,0,4,39,0
  2007CLS
  2010PRINTCHR$135;CHR$157;CHR$130;"MAGIC UNITS"'CHR$135;CHR$157
  2020PRINTCHR$135;CHR$157;CHR$130;"You have just used";CHR$133;R;CHR$130;"units"
  2030PRINTCHR$135;CHR$157;CHR$130;"You have";CHR$133;M;CHR$130;"units left"'CHR$135;CHR$157;
  2040ENDPROC
  2500DEF PROCwindow2
  2510VDU28,0,10,39,5
  2515CLS
  2520PRINTCHR$135;CHR$157;CHR$132;"LOCATION"'CHR$135;CHR$157
  2530PRINTCHR$135;CHR$157;CHR$132;"Tunnels lead to chambers";CHR$133;
  2540FOR I=0 TO 3
  2550IF BB(I)>0 PRINT;BB(I);",";
  2560NEXT
  2570VDU127
  2580PRINT'CHR$135;CHR$157;CHR$132;"You are currently in chamber";CHR$133;Y
  2590PRINTCHR$135;CHR$157
  2600ENDPROC
  3000DEF PROCwindow3
  3010VDU28,0,24,39,10
  3015PRINTTAB(0,13)
  3020ENDPROC
  5000DEF PROCplan
  5010VDU26
  5030CLS
  5035VDU23,0,11,0,0,0,0,0,0,0
  5040FOR I%=0TO24:PRINTCHR$147:NEXT
  5050PRINTTAB(0,10);CHR$130;TAB(0,11);CHR$130
  5060VDU28,1,24,39,0
  5070PRINTCHR$12
  5090Z$=STRING$(10,CHR$172)
  5100 PRINTTAB(8);CHR$232;Z$;CHR$130;"1";CHR$147;Z$;CHR$236
  5200PRINTTAB(8);CHR$234;TAB(20);CHR$234;TAB(32);CHR$234'TAB(7);CHR$130;"2";TAB(19);CHR$130;"3";TAB(31);CHR$130;"4"
  5210PRINTTAB(7);CHR$224;CHR$238;CHR$228;TAB(19);CHR$224;CHR$238;CHR$228;TAB(31);CHR$224;CHR$238;CHR$228
  5220Z$=CHR$184+CHR$161+CHR$234+CHR$32+CHR$169+CHR$176
  5230PRINTTAB(6);Z$;SPC(6);Z$;SPC(6);Z$
  5240Z$=CHR$224+CHR$166+CHR$32+CHR$32+CHR$234+CHR$32+CHR$32+CHR$162+CHR$228
  5250PRINTTAB(4);Z$;SPC(3);Z$;SPC(3);Z$
  5260PRINTCHR$130;TAB(4);"5   6   7   8   9  10  11  12  13"
  5270Z$=CHR$32+CHR$224+CHR$238+CHR$228
  5280Y$=STRING$(8,Z$)
  5290PRINTTAB(2);CHR$224;CHR$166;CHR$183;CHR$228;Y$
  5300Z$=CHR$32+CHR$182+CHR$186+CHR$234
  5310Y$=STRING$(8,Z$)
  5315PRINTTAB(1);CHR$184;CHR$225;CHR$166;CHR$224;CHR$166;Y$
  5330PRINT"1";CHR$147;CHR$234;CHR$130;"1";CHR$158;CHR$147;CHR$181;CHR$130;"1";CHR$147;CHR$181;CHR$130;"2";CHR$147;CHR$181;CHR$130;"2";CHR$147;CHR$181;CHR$130;"2";CHR$147;CHR$181;CHR$130;"3";CHR$147;CHR$181;CHR$130;"3";
  5340PRINTCHR$147;CHR$181;CHR$130;"3";CHR$147;CHR$181;CHR$130;"4"
  5350PRINT"4";CHR$147;CHR$234;CHR$130;"6";CHR$158;CHR$147;CHR$181;CHR$130;"9";CHR$147;CHR$181;CHR$130;"2";CHR$147;CHR$181;CHR$130;"5";CHR$147;CHR$181;CHR$130;"8";CHR$147;CHR$181;CHR$130;"1";CHR$147;CHR$181;CHR$130;"4";
  5360PRINTCHR$147;CHR$181;CHR$130;"7";CHR$147;CHR$181;CHR$130;"0"
  5370VDU234,240,242,184,235,224,166,184,161,250,234,225,165,250,234,225,165,250,234,225,165,250,234,225,165,250,234,225,165,250,234,225,165,250,224,181,181,234
  5380VDU10,13,32,32,232,32,234,246,240,241,166,234,246,242,186,234,246,242,186,234,166,234,186,234,246,242,186,234,246,242,186,234,246,242,186,234,246,240,241,250
  5390VDU10,13,32,32,234,130,49,147,32,180,130,50,147,232,130,50,147,232,130,50,32,50,32,50,147,232,130,51,147,232,130,51,147,232,130,51,147,32,180
  5400VDU10,13,32,32,234,130,55,147,32,181,130,48,147,234,130,51,147,234,130,54,32,55,32,57,147,234,130,50,147,234,130,53,147,234,130,56,147,32,181
  5410VDU10,13,32,32,234,32,32,32,32,181,32,32,32,234,32,32,32,234,32,234,240,250,32,32,32,234,32,32,32,234,32,32,32,234,32,32,32,32,181
  5420PRINT'CHR$130;" 15  18   21  24      30  33  36  39"
  5430VDU32,32,234,32,32,32,32,173,236,232,172,174,32,32,32,234,32,32,32,32,32,32,32,234,32,32,32,170,172,180,188,174,32,32,32,32,181
  5440VDU10,13,32,32,170,172,172,172,172,130,52,49,147,172,172,172,172,174,32,32,32,32,32,32,32,170,172,172,172,172,130,52,50,147,172,172,172,172,165
  5450PRINT''CHR$135;"NB - CELLS";CHR$130;"14";CHR$135;"AND";CHR$130;"40";CHR$135;"ARE CONNECTED"
  5460PRINTCHR$133;"You are at cell";CHR$136;Y'CHR$133;"Press any key to continue"
  5470*FX15,0
  6000ZZZ=GET
  6005VDU26:CLS:VDU23,0,11,255,0,0,0,0,0,0
  6010ENDPROC