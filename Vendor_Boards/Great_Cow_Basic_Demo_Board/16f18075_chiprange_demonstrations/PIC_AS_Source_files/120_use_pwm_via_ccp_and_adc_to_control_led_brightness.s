;Program compiled by Great Cow BASIC (1.00.00 Release Candidate 2022-09-11 (Windows 64 bit) : Build 1168x) for Microchip PIC-AS
;  See the GCBASIC forums at http://sourceforge.net/projects/gcbasic/forums,
;  Check the documentation and Help at http://gcbasic.sourceforge.net/help/,
;or, email:
;   evanvennn at users dot sourceforge dot net

;********************************************************************************


;Set up the assembler options (Chip type, clock source, other bits and pieces)
;PROCESSOR   16F18075
 PAGEWIDTH   180
 RADIX       DEC
 TITLE       "d:\GreatCowBASICGits\Demonstration_Sources.git\trunk\Vendor_Boards\Great_Cow_Basic_Demo_Board\16f18075_chiprange_demonstrations\120_use_pwm_via_ccp_and_adc_to_control_led_brightness.s"
 SUBTITLE    "09-11-2022"

; Reverse lookup file(s)
; C:\Program Files\Microchip\xc8\v2.40\pic\include\proc\pic16f18075.inc
; C:\Program Files\Microchip\xc8\v2.40\pic\dat\cfgmap\16f18075.cfgmap
; Alternative CONFIG file is to be found at C:\Program Files\Microchip\xc8\vX.YY\pic\dat\cfgdata as per Microchip support ticket #00730936 

;********************************************************************************

;********************************************************************************
;Explicit CONFIG
 CONFIG CLKOUTEN=OFF                             ;C1 Reverselookup CLKOUTEN = OFF
 CONFIG RSTOSC=HFINTOSC_32MHz                    ;C1 Reverselookup RSTOSC = HFINTOSC_32MHZ
 CONFIG FEXTOSC=OFF                              ;C1 Reverselookup FEXTOSC = OFF
 CONFIG WDTE=OFF                                 ;C1 Reverselookup WDTE = OFF
 CONFIG MCLRE=INTMCLR                            ;C1 Reverselookup MCLRE = INTMCLR
 CONFIG LVP=OFF                                  ;C1 Reverselookup LVP = OFF
 CONFIG WRTSAF=OFF                               ;C1 Reverselookup WRTSAF = OFF
 CONFIG WRTD=OFF                                 ;C1 Reverselookup WRTD = OFF
 CONFIG WRTB=OFF                                 ;C1 Reverselookup WRTB = OFF
 CONFIG CPD=OFF                                  ;C1 Reverselookup CPD = OFF
 CONFIG CP=OFF                                   ;C1 Reverselookup CP = OFF
;Inferred CONFIG


;********************************************************************************
; The XC8 xc.inc include file.  This MUST be placed after the CONFIG statements.

 #include <xc.inc>

;********************************************************************************

;Set aside RAM memory locations for variables. All variables are global.
 ADREADPORT                       EQU 32          ; 0X20
 CCPCONCACHE                      EQU 33          ; 0X21
 DELAYTEMP                        EQU 112          ; 0X70
 DELAYTEMP2                       EQU 113          ; 0X71
 PRX_TEMP                         EQU 34          ; 0X22
 PRX_TEMP_E                       EQU 37          ; 0X25
 PRX_TEMP_H                       EQU 35          ; 0X23
 PRX_TEMP_U                       EQU 36          ; 0X24
 PWMCHANNEL                       EQU 38          ; 0X26
 PWMDUTY                          EQU 39          ; 0X27
 PWMDUTY_H                        EQU 40          ; 0X28
 PWMFREQ                          EQU 41          ; 0X29
 PWMRESOLUTION                    EQU 42          ; 0X2A
 PWMRESOLUTION_H                  EQU 43          ; 0X2B
 READAD                           EQU 44          ; 0X2C
 SYSBYTETEMPX                     EQU 112          ; 0X70
 SYSDIVLOOP                       EQU 116          ; 0X74
 SYSLONGDIVMULTA                  EQU 45          ; 0X2D
 SYSLONGDIVMULTA_E                EQU 48          ; 0X30
 SYSLONGDIVMULTA_H                EQU 46          ; 0X2E
 SYSLONGDIVMULTA_U                EQU 47          ; 0X2F
 SYSLONGDIVMULTB                  EQU 49          ; 0X31
 SYSLONGDIVMULTB_E                EQU 52          ; 0X34
 SYSLONGDIVMULTB_H                EQU 50          ; 0X32
 SYSLONGDIVMULTB_U                EQU 51          ; 0X33
 SYSLONGDIVMULTX                  EQU 53          ; 0X35
 SYSLONGDIVMULTX_E                EQU 56          ; 0X38
 SYSLONGDIVMULTX_H                EQU 54          ; 0X36
 SYSLONGDIVMULTX_U                EQU 55          ; 0X37
 SYSLONGTEMPA                     EQU 117          ; 0X75
 SYSLONGTEMPA_E                   EQU 120          ; 0X78
 SYSLONGTEMPA_H                   EQU 118          ; 0X76
 SYSLONGTEMPA_U                   EQU 119          ; 0X77
 SYSLONGTEMPB                     EQU 121          ; 0X79
 SYSLONGTEMPB_E                   EQU 124          ; 0X7C
 SYSLONGTEMPB_H                   EQU 122          ; 0X7A
 SYSLONGTEMPB_U                   EQU 123          ; 0X7B
 SYSLONGTEMPX                     EQU 112          ; 0X70
 SYSLONGTEMPX_E                   EQU 115          ; 0X73
 SYSLONGTEMPX_H                   EQU 113          ; 0X71
 SYSLONGTEMPX_U                   EQU 114          ; 0X72
 SYSREPEATTEMP1                   EQU 57          ; 0X39
 SYSTEMP1                         EQU 58          ; 0X3A
 SYSTEMP1_E                       EQU 61          ; 0X3D
 SYSTEMP1_H                       EQU 59          ; 0X3B
 SYSTEMP1_U                       EQU 60          ; 0X3C
 SYSWAITTEMP10US                  EQU 117          ; 0X75
 SYSWAITTEMPMS                    EQU 114          ; 0X72
 SYSWAITTEMPMS_H                  EQU 115          ; 0X73
 TIMERSELECTIONBITS               EQU 62          ; 0X3E
 TX_PR                            EQU 63          ; 0X3F
 _PWMTIMERSELECTED                EQU 64          ; 0X40

;********************************************************************************

;ALIAS VARIABLES
 SYSREADADBYTE                    EQU 44

;********************************************************************************

 PSECT   PROGMEM0,delta=2, abs
 RESETVEC:
;VECTORS
	ORG	0
	PAGESEL	BASPROGRAMSTART
	GOTO	BASPROGRAMSTART
	ORG	4
	RETFIE

;********************************************************************************

;START OF PROGRAM MEMORY PAGE 0
	ORG	5
BASPROGRAMSTART:
;CALL INITIALISATION ROUTINES
	CALL	INITSYS
	CALL	INITPPS
	CALL	INITPWM

;START OF THE MAIN PROGRAM
	BCF	TRISB,1
	BCF	TRISB,2
	BCF	TRISB,3
	BCF	TRISB,4
	BSF	TRISA,0
	BSF	TRISB,5
SYSDOLOOP_S1:
	MOVLW	2
	MOVWF	PWMCHANNEL
	MOVLW	40
	MOVWF	PWMFREQ
	CLRF	ADREADPORT
	CALL	FN_READAD5
	MOVF	SYSREADADBYTE,W
	MOVWF	PWMDUTY
	CLRF	PWMDUTY_H
	MOVLW	2
	MOVWF	_PWMTIMERSELECTED
	CALL	HPWM_CCPTIMERN
	MOVLW	1
	MOVWF	PWMCHANNEL
	MOVLW	20
	MOVWF	PWMFREQ
	CLRF	ADREADPORT
	CALL	FN_READAD5
	MOVF	SYSREADADBYTE,W
	MOVWF	PWMDUTY
	CLRF	PWMDUTY_H
	MOVLW	4
	MOVWF	_PWMTIMERSELECTED
	CALL	HPWM_CCPTIMERN
	MOVLW	10
	MOVWF	SYSWAITTEMPMS
	CLRF	SYSWAITTEMPMS_H
	CALL	DELAY_MS
	GOTO	SYSDOLOOP_S1
SYSDOLOOP_E1:
BASPROGRAMEND:
	SLEEP
	GOTO	BASPROGRAMEND

;********************************************************************************

CALCULATEDUTY:
	MOVLW	1
	ADDWF	PRX_TEMP,W
	MOVWF	SYSTEMP1
	MOVLW	0
	ADDWFC	PRX_TEMP_H,W
	MOVWF	SYSTEMP1_H
	MOVLW	0
	ADDWFC	PRX_TEMP_U,W
	MOVWF	SYSTEMP1_U
	MOVLW	0
	ADDWFC	PRX_TEMP_E,W
	MOVWF	SYSTEMP1_E
	MOVF	PWMDUTY,W
	MOVWF	SYSLONGTEMPA
	MOVF	PWMDUTY_H,W
	MOVWF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	MOVF	SYSTEMP1,W
	MOVWF	SYSLONGTEMPB
	MOVF	SYSTEMP1_H,W
	MOVWF	SYSLONGTEMPB_H
	MOVF	SYSTEMP1_U,W
	MOVWF	SYSLONGTEMPB_U
	MOVF	SYSTEMP1_E,W
	MOVWF	SYSLONGTEMPB_E
	CALL	SYSMULTSUB32
	MOVF	SYSLONGTEMPX,W
	MOVWF	PRX_TEMP
	MOVF	SYSLONGTEMPX_H,W
	MOVWF	PRX_TEMP_H
	MOVF	SYSLONGTEMPX_U,W
	MOVWF	PRX_TEMP_U
	MOVF	SYSLONGTEMPX_E,W
	MOVWF	PRX_TEMP_E
	BCF	STATUS,0
	MOVLW	2
	MOVWF	SYSREPEATTEMP1
SYSREPEATLOOP1:
	RLF	PRX_TEMP,F
	RLF	PRX_TEMP_H,F
	RLF	PRX_TEMP_U,F
	RLF	PRX_TEMP_E,F
	DECFSZ	SYSREPEATTEMP1,F
	GOTO	SYSREPEATLOOP1
SYSREPEATLOOPEND1:
	MOVF	PRX_TEMP,W
	MOVWF	SYSLONGTEMPA
	MOVF	PRX_TEMP_H,W
	MOVWF	SYSLONGTEMPA_H
	MOVF	PRX_TEMP_U,W
	MOVWF	SYSLONGTEMPA_U
	MOVF	PRX_TEMP_E,W
	MOVWF	SYSLONGTEMPA_E
	MOVF	PWMRESOLUTION,W
	MOVWF	SYSLONGTEMPB
	MOVF	PWMRESOLUTION_H,W
	MOVWF	SYSLONGTEMPB_H
	CLRF	SYSLONGTEMPB_U
	CLRF	SYSLONGTEMPB_E
	CALL	SYSDIVSUB32
	MOVF	SYSLONGTEMPA,W
	MOVWF	PRX_TEMP
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	PRX_TEMP_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	PRX_TEMP_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	PRX_TEMP_E
	BCF	STATUS,0
	MOVLW	6
	MOVWF	SYSREPEATTEMP1
SYSREPEATLOOP2:
	RLF	PRX_TEMP,F
	RLF	PRX_TEMP_H,F
	RLF	PRX_TEMP_U,F
	RLF	PRX_TEMP_E,F
	DECFSZ	SYSREPEATTEMP1,F
	GOTO	SYSREPEATLOOP2
SYSREPEATLOOPEND2:
	RETURN

;********************************************************************************

DELAY_10US:
D10US_START:
	MOVLW	25
	MOVWF	DELAYTEMP
DELAYUS0:
	DECFSZ	DELAYTEMP,F
	GOTO	DELAYUS0
	NOP
	DECFSZ	SYSWAITTEMP10US, F
	GOTO	D10US_START
	RETURN

;********************************************************************************

DELAY_MS:
	INCF	SYSWAITTEMPMS_H, F
DMS_START:
	MOVLW	14
	MOVWF	DELAYTEMP2
DMS_OUTER:
	MOVLW	189
	MOVWF	DELAYTEMP
DMS_INNER:
	DECFSZ	DELAYTEMP, F
	GOTO	DMS_INNER
	DECFSZ	DELAYTEMP2, F
	GOTO	DMS_OUTER
	DECFSZ	SYSWAITTEMPMS, F
	GOTO	DMS_START
	DECFSZ	SYSWAITTEMPMS_H, F
	GOTO	DMS_START
	RETURN

;********************************************************************************

HPWM25:
	MOVLW	255
	MOVWF	PWMRESOLUTION
	CLRF	PWMRESOLUTION_H
	MOVLW	1
	MOVWF	TX_PR
	MOVLW	64
	MOVWF	SYSLONGTEMPA
	MOVLW	31
	MOVWF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	MOVF	PWMFREQ,W
	MOVWF	SYSLONGTEMPB
	CLRF	SYSLONGTEMPB_H
	CLRF	SYSLONGTEMPB_U
	CLRF	SYSLONGTEMPB_E
	CALL	SYSDIVSUB32
	MOVF	SYSLONGTEMPA,W
	MOVWF	PRX_TEMP
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	PRX_TEMP_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	PRX_TEMP_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	PRX_TEMP_E
	MOVF	PRX_TEMP_H,W
	SUBLW	0
	BTFSC	STATUS,0
	GOTO	ENDIF2
	MOVLW	4
	MOVWF	TX_PR
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
ENDIF2:
	MOVF	PRX_TEMP_H,W
	SUBLW	0
	BTFSC	STATUS,0
	GOTO	ENDIF3
	MOVLW	16
	MOVWF	TX_PR
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
ENDIF3:
	MOVF	PRX_TEMP_H,W
	SUBLW	0
	BTFSC	STATUS,0
	GOTO	ENDIF4
	MOVLW	64
	MOVWF	TX_PR
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
ENDIF4:
CCPPWMSETUPCLOCKSOURCE:
SYSSELECT3CASE1:
	MOVLW	2
	SUBWF	_PWMTIMERSELECTED,W
	BTFSS	STATUS,2
	GOTO	SYSSELECT3CASE2
	MOVF	PRX_TEMP,W
	BANKSEL	T2PR
	MOVWF	T2PR
	BCF	T2CON,4
	BCF	T2CON,5
	BCF	T2CON,6
	MOVLW	4
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF5
	BANKSEL	T2CON
	BSF	T2CON,5
ENDIF5:
	MOVLW	16
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF6
	BANKSEL	T2CON
	BSF	T2CON,6
ENDIF6:
	MOVLW	64
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF7
	BANKSEL	T2CON
	BSF	T2CON,6
	BSF	T2CON,5
ENDIF7:
	BANKSEL	T2CLKCON
	BSF	T2CLKCON,0
	BCF	T2CLKCON,1
	BCF	T2CLKCON,2
	BCF	T2CLKCON,3
	GOTO	SYSSELECTEND3
SYSSELECT3CASE2:
	MOVLW	4
	SUBWF	_PWMTIMERSELECTED,W
	BTFSS	STATUS,2
	GOTO	SYSSELECTEND3
	MOVF	PRX_TEMP,W
	BANKSEL	T4PR
	MOVWF	T4PR
	BCF	T4CON,4
	BCF	T4CON,5
	MOVLW	4
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF8
	BANKSEL	T4CON
	BSF	T4CON,4
ENDIF8:
	MOVLW	16
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF9
	BANKSEL	T4CON
	BSF	T4CON,5
ENDIF9:
	MOVLW	64
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF10
	BANKSEL	T4CON
	BSF	T4CON,4
	BSF	T4CON,5
ENDIF10:
	BANKSEL	T4CLKCON
	BSF	T4CLKCON,0
	BCF	T4CLKCON,1
	BCF	T4CLKCON,2
	BCF	T4CLKCON,3
SYSSELECTEND3:
END_OF_CCPPWMSETUPCLOCKSOURCE:
SETUPTHECORRECTTIMERBITS:
	BCF	STATUS,0
	BANKSEL	_PWMTIMERSELECTED
	RRF	_PWMTIMERSELECTED,W
	MOVWF	TIMERSELECTIONBITS
SETUPCCPPWMREGISTERS:
	DECF	PWMCHANNEL,W
	BTFSS	STATUS,2
	GOTO	ENDIF11
	CALL	CALCULATEDUTY
	MOVF	PRX_TEMP_H,W
	BANKSEL	CCPR1H
	MOVWF	CCPR1H
	BANKSEL	PRX_TEMP
	MOVF	PRX_TEMP,W
	BANKSEL	CCPR1L
	MOVWF	CCPR1L
	BSF	CCP1CON,3
	BSF	CCP1CON,2
	BSF	CCP1CON,1
	BSF	CCP1CON,0
	BSF	CCP1CON,7
	BSF	CCP1CON,4
ENDIF11:
	MOVLW	2
	BANKSEL	PWMCHANNEL
	SUBWF	PWMCHANNEL,W
	BTFSS	STATUS,2
	GOTO	ENDIF12
	CALL	CALCULATEDUTY
	MOVF	PRX_TEMP_H,W
	BANKSEL	CCPR2H
	MOVWF	CCPR2H
	BANKSEL	PRX_TEMP
	MOVF	PRX_TEMP,W
	BANKSEL	CCPR2L
	MOVWF	CCPR2L
	BSF	CCP2CON,3
	BSF	CCP2CON,2
	BSF	CCP2CON,1
	BSF	CCP2CON,0
	BSF	CCP2CON,7
	BSF	CCP2CON,7
	BSF	CCP2CON,4
ENDIF12:
	BANKSEL	STATUS
	RETURN

;********************************************************************************

HPWM_CCPTIMERN:
SYSSELECT2CASE1:
	MOVLW	2
	SUBWF	_PWMTIMERSELECTED,W
	BTFSS	STATUS,2
	GOTO	SYSSELECT2CASE2
	CALL	HPWM25
	BANKSEL	T2CON
	BSF	T2CON,7
	GOTO	SYSSELECTEND2
SYSSELECT2CASE2:
	MOVLW	4
	SUBWF	_PWMTIMERSELECTED,W
	BTFSS	STATUS,2
	GOTO	SYSSELECTEND2
	CALL	HPWM25
	BANKSEL	T4CON
	BSF	T4CON,7
SYSSELECTEND2:
	MOVLW	2
	BANKSEL	_PWMTIMERSELECTED
	MOVWF	_PWMTIMERSELECTED
	RETURN

;********************************************************************************

INITPPS:
	MOVLW	9
	BANKSEL	RB1PPS
	MOVWF	RB1PPS
	MOVLW	9
	BANKSEL	CCP1PPS
	MOVWF	CCP1PPS
	MOVLW	10
	BANKSEL	RB2PPS
	MOVWF	RB2PPS
	MOVLW	10
	BANKSEL	CCP2PPS
	MOVWF	CCP2PPS
	BANKSEL	STATUS
	RETURN

;********************************************************************************

INITPWM:
	MOVLW	2
	MOVWF	_PWMTIMERSELECTED
LEGACY_STARTOFFIXEDCCPPWMMODECODE:
	CLRF	CCPCONCACHE
	MOVLW	210
	BANKSEL	T2PR
	MOVWF	T2PR
	BCF	T2CON,4
	BCF	T2CON,5
	BCF	T2CON,6
	BANKSEL	CCPCONCACHE
	BSF	CCPCONCACHE,4
	MOVLW	105
	BANKSEL	CCPR1H
	MOVWF	CCPR1H
	MOVLW	128
	MOVWF	CCPR1L
	MOVLW	1
	BANKSEL	T2CLKCON
	MOVWF	T2CLKCON
	BANKSEL	CCPCONCACHE
	BSF	CCPCONCACHE,7
	BSF	CCPCONCACHE,3
	BSF	CCPCONCACHE,2
	BCF	CCPCONCACHE,1
	BCF	CCPCONCACHE,0
	BANKSEL	T2CON
	BSF	T2CON,7
STARTOFFIXEDPWMMODECODE:
SETPWMDUTYCODE:
REV2018_ENDOFFIXEDPWMMODECODE:
	BANKSEL	STATUS
	RETURN

;********************************************************************************

INITSYS:
;asm showdebug This code block sets the internal oscillator to ChipMHz
	BANKSEL	OSCCON2
	CLRF	OSCCON2
	CLRF	OSCCON3
	MOVLW	5
	MOVWF	OSCFRQ
;asm showdebug _Complete_the_chip_setup_of_BSR,ADCs,ANSEL_and_other_key_setup_registers_or_register_bits
	BANKSEL	ADCON0
	BCF	ADCON0,2
	BCF	ADCON0,7
	BANKSEL	ANSELA
	CLRF	ANSELA
	CLRF	ANSELB
	CLRF	ANSELC
	CLRF	ANSELD
	CLRF	ANSELE
	BANKSEL	CM1CON0
	BCF	CM1CON0,7
	BANKSEL	PORTA
	CLRF	PORTA
	CLRF	PORTB
	CLRF	PORTC
	CLRF	PORTD
	CLRF	PORTE
	RETURN

;********************************************************************************

FN_READAD5:
	BANKSEL	ADCON0
	BCF	ADCON0,2
	BANKSEL	ADREADPORT
	MOVF	ADREADPORT,W
	BANKSEL	ADPCH
	MOVWF	ADPCH
SYSSELECTEND1:
	BCF	ADCON0,4
	MOVLW	1
	MOVWF	ADCLK
	BCF	ADCON0,4
	MOVLW	15
	MOVWF	ADCLK
	BCF	ADCON0,2
	BCF	ADCON0,2
	BANKSEL	ADREADPORT
	MOVF	ADREADPORT,W
	BANKSEL	ADPCH
	MOVWF	ADPCH
	BSF	ADCON0,7
	MOVLW	2
	MOVWF	SYSWAITTEMP10US
	BANKSEL	STATUS
	CALL	DELAY_10US
	BANKSEL	ADCON0
	BSF	ADCON0,0
	NOP
SYSWAITLOOP1:
	BTFSC	ADCON0,0
	GOTO	SYSWAITLOOP1
	BCF	ADCON0,7
	BANKSEL	ANSELA
	CLRF	ANSELA
	CLRF	ANSELB
	CLRF	ANSELC
	CLRF	ANSELD
	CLRF	ANSELE
	BANKSEL	ADRESH
	MOVF	ADRESH,W
	BANKSEL	READAD
	MOVWF	READAD
	BANKSEL	ADCON0
	BCF	ADCON0,2
	BANKSEL	STATUS
	RETURN

;********************************************************************************

SYSCOMPEQUAL32:
	CLRF	SYSBYTETEMPX
	MOVF	SYSLONGTEMPA, W
	SUBWF	SYSLONGTEMPB, W
	BTFSS	STATUS,2
	RETURN
	MOVF	SYSLONGTEMPA_H, W
	SUBWF	SYSLONGTEMPB_H, W
	BTFSS	STATUS,2
	RETURN
	MOVF	SYSLONGTEMPA_U, W
	SUBWF	SYSLONGTEMPB_U, W
	BTFSS	STATUS,2
	RETURN
	MOVF	SYSLONGTEMPA_E, W
	SUBWF	SYSLONGTEMPB_E, W
	BTFSS	STATUS,2
	RETURN
	COMF	SYSBYTETEMPX,F
	RETURN

;********************************************************************************

SYSCOMPLESSTHAN32:
	CLRF	SYSBYTETEMPX
	MOVF	SYSLONGTEMPA_E,W
	SUBWF	SYSLONGTEMPB_E,W
	BTFSS	STATUS,0
	RETURN
	BTFSS	STATUS,2
	GOTO	SCLT32TRUE
	MOVF	SYSLONGTEMPA_U,W
	SUBWF	SYSLONGTEMPB_U,W
	BTFSS	STATUS,0
	RETURN
	BTFSS	STATUS,2
	GOTO	SCLT32TRUE
	MOVF	SYSLONGTEMPA_H,W
	SUBWF	SYSLONGTEMPB_H,W
	BTFSS	STATUS,0
	RETURN
	BTFSS	STATUS,2
	GOTO	SCLT32TRUE
	MOVF	SYSLONGTEMPB,W
	SUBWF	SYSLONGTEMPA,W
	BTFSC	STATUS,0
	RETURN
SCLT32TRUE:
	COMF	SYSBYTETEMPX,F
	RETURN

;********************************************************************************

SYSDIVSUB32:
	MOVF	SYSLONGTEMPA,W
	MOVWF	SYSLONGDIVMULTA
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	SYSLONGDIVMULTA_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	SYSLONGDIVMULTA_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	SYSLONGDIVMULTA_E
	MOVF	SYSLONGTEMPB,W
	MOVWF	SYSLONGDIVMULTB
	MOVF	SYSLONGTEMPB_H,W
	MOVWF	SYSLONGDIVMULTB_H
	MOVF	SYSLONGTEMPB_U,W
	MOVWF	SYSLONGDIVMULTB_U
	MOVF	SYSLONGTEMPB_E,W
	MOVWF	SYSLONGDIVMULTB_E
	CLRF	SYSLONGDIVMULTX
	CLRF	SYSLONGDIVMULTX_H
	CLRF	SYSLONGDIVMULTX_U
	CLRF	SYSLONGDIVMULTX_E
	MOVF	SYSLONGDIVMULTB,W
	MOVWF	SYSLONGTEMPA
	MOVF	SYSLONGDIVMULTB_H,W
	MOVWF	SYSLONGTEMPA_H
	MOVF	SYSLONGDIVMULTB_U,W
	MOVWF	SYSLONGTEMPA_U
	MOVF	SYSLONGDIVMULTB_E,W
	MOVWF	SYSLONGTEMPA_E
	CLRF	SYSLONGTEMPB
	CLRF	SYSLONGTEMPB_H
	CLRF	SYSLONGTEMPB_U
	CLRF	SYSLONGTEMPB_E
	CALL	SYSCOMPEQUAL32
	BTFSS	SYSBYTETEMPX,0
	GOTO	ENDIF15
	CLRF	SYSLONGTEMPA
	CLRF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	RETURN
ENDIF15:
	MOVLW	32
	MOVWF	SYSDIVLOOP
SYSDIV32START:
	BCF	STATUS,0
	RLF	SYSLONGDIVMULTA,F
	RLF	SYSLONGDIVMULTA_H,F
	RLF	SYSLONGDIVMULTA_U,F
	RLF	SYSLONGDIVMULTA_E,F
	RLF	SYSLONGDIVMULTX,F
	RLF	SYSLONGDIVMULTX_H,F
	RLF	SYSLONGDIVMULTX_U,F
	RLF	SYSLONGDIVMULTX_E,F
	MOVF	SYSLONGDIVMULTB,W
	SUBWF	SYSLONGDIVMULTX,F
	MOVF	SYSLONGDIVMULTB_H,W
	SUBWFB	SYSLONGDIVMULTX_H,F
	MOVF	SYSLONGDIVMULTB_U,W
	SUBWFB	SYSLONGDIVMULTX_U,F
	MOVF	SYSLONGDIVMULTB_E,W
	SUBWFB	SYSLONGDIVMULTX_E,F
	BSF	SYSLONGDIVMULTA,0
	BTFSC	STATUS,0
	GOTO	ENDIF16
	BCF	SYSLONGDIVMULTA,0
	MOVF	SYSLONGDIVMULTB,W
	ADDWF	SYSLONGDIVMULTX,F
	MOVF	SYSLONGDIVMULTB_H,W
	ADDWFC	SYSLONGDIVMULTX_H,F
	MOVF	SYSLONGDIVMULTB_U,W
	ADDWFC	SYSLONGDIVMULTX_U,F
	MOVF	SYSLONGDIVMULTB_E,W
	ADDWFC	SYSLONGDIVMULTX_E,F
ENDIF16:
	DECFSZ	SYSDIVLOOP, F
	GOTO	SYSDIV32START
	MOVF	SYSLONGDIVMULTA,W
	MOVWF	SYSLONGTEMPA
	MOVF	SYSLONGDIVMULTA_H,W
	MOVWF	SYSLONGTEMPA_H
	MOVF	SYSLONGDIVMULTA_U,W
	MOVWF	SYSLONGTEMPA_U
	MOVF	SYSLONGDIVMULTA_E,W
	MOVWF	SYSLONGTEMPA_E
	MOVF	SYSLONGDIVMULTX,W
	MOVWF	SYSLONGTEMPX
	MOVF	SYSLONGDIVMULTX_H,W
	MOVWF	SYSLONGTEMPX_H
	MOVF	SYSLONGDIVMULTX_U,W
	MOVWF	SYSLONGTEMPX_U
	MOVF	SYSLONGDIVMULTX_E,W
	MOVWF	SYSLONGTEMPX_E
	RETURN

;********************************************************************************

SYSMULTSUB32:
	MOVF	SYSLONGTEMPA,W
	MOVWF	SYSLONGDIVMULTA
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	SYSLONGDIVMULTA_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	SYSLONGDIVMULTA_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	SYSLONGDIVMULTA_E
	MOVF	SYSLONGTEMPB,W
	MOVWF	SYSLONGDIVMULTB
	MOVF	SYSLONGTEMPB_H,W
	MOVWF	SYSLONGDIVMULTB_H
	MOVF	SYSLONGTEMPB_U,W
	MOVWF	SYSLONGDIVMULTB_U
	MOVF	SYSLONGTEMPB_E,W
	MOVWF	SYSLONGDIVMULTB_E
	CLRF	SYSLONGDIVMULTX
	CLRF	SYSLONGDIVMULTX_H
	CLRF	SYSLONGDIVMULTX_U
	CLRF	SYSLONGDIVMULTX_E
MUL32LOOP:
	BTFSS	SYSLONGDIVMULTB,0
	GOTO	ENDIF13
	MOVF	SYSLONGDIVMULTA,W
	ADDWF	SYSLONGDIVMULTX,F
	MOVF	SYSLONGDIVMULTA_H,W
	ADDWFC	SYSLONGDIVMULTX_H,F
	MOVF	SYSLONGDIVMULTA_U,W
	ADDWFC	SYSLONGDIVMULTX_U,F
	MOVF	SYSLONGDIVMULTA_E,W
	ADDWFC	SYSLONGDIVMULTX_E,F
ENDIF13:
	BCF	STATUS,0
	RRF	SYSLONGDIVMULTB_E,F
	RRF	SYSLONGDIVMULTB_U,F
	RRF	SYSLONGDIVMULTB_H,F
	RRF	SYSLONGDIVMULTB,F
	BCF	STATUS,0
	RLF	SYSLONGDIVMULTA,F
	RLF	SYSLONGDIVMULTA_H,F
	RLF	SYSLONGDIVMULTA_U,F
	RLF	SYSLONGDIVMULTA_E,F
	MOVF	SYSLONGDIVMULTB,W
	MOVWF	SYSLONGTEMPB
	MOVF	SYSLONGDIVMULTB_H,W
	MOVWF	SYSLONGTEMPB_H
	MOVF	SYSLONGDIVMULTB_U,W
	MOVWF	SYSLONGTEMPB_U
	MOVF	SYSLONGDIVMULTB_E,W
	MOVWF	SYSLONGTEMPB_E
	CLRF	SYSLONGTEMPA
	CLRF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	CALL	SYSCOMPLESSTHAN32
	BTFSC	SYSBYTETEMPX,0
	GOTO	MUL32LOOP
	MOVF	SYSLONGDIVMULTX,W
	MOVWF	SYSLONGTEMPX
	MOVF	SYSLONGDIVMULTX_H,W
	MOVWF	SYSLONGTEMPX_H
	MOVF	SYSLONGDIVMULTX_U,W
	MOVWF	SYSLONGTEMPX_U
	MOVF	SYSLONGDIVMULTX_E,W
	MOVWF	SYSLONGTEMPX_E
	RETURN

;********************************************************************************

;START OF PROGRAM MEMORY PAGE 1
	PSECT	PROGMEM1,CLASS=CODE,SPACE=SPACE_CODE,DELTA=2, ABS, OVRLD 
	ORG	2048
;START OF PROGRAM MEMORY PAGE 2
	PSECT	PROGMEM2,CLASS=CODE,SPACE=SPACE_CODE,DELTA=2, ABS, OVRLD 
	ORG	4096
;START OF PROGRAM MEMORY PAGE 3
	PSECT	PROGMEM3,CLASS=CODE,SPACE=SPACE_CODE,DELTA=2, ABS, OVRLD 
	ORG	6144
;
; Declare Power-On-Reset entry point
;
 END     RESETVEC
