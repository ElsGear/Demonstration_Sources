;Program compiled by Great Cow BASIC (1.00.00 Release Candidate 2022-09-11 (Windows 64 bit) : Build 1168x) for Microchip PIC-AS
;  See the GCBASIC forums at http://sourceforge.net/projects/gcbasic/forums,
;  Check the documentation and Help at http://gcbasic.sourceforge.net/help/,
;or, email:
;   evanvennn at users dot sourceforge dot net

;********************************************************************************


;Set up the assembler options (Chip type, clock source, other bits and pieces)
;PROCESSOR   16F18075
 PAGEWIDTH   180
 RADIX       DEC
 TITLE       "d:\GreatCowBASICGits\Demonstration_Sources.git\trunk\Vendor_Boards\Great_Cow_Basic_Demo_Board\16f18075_chiprange_demonstrations\250_pwm_variable_modes.s"
 SUBTITLE    "09-11-2022"

; Reverse lookup file(s)
; C:\Program Files\Microchip\xc8\v2.40\pic\include\proc\pic16f18075.inc
; C:\Program Files\Microchip\xc8\v2.40\pic\dat\cfgmap\16f18075.cfgmap
; Alternative CONFIG file is to be found at C:\Program Files\Microchip\xc8\vX.YY\pic\dat\cfgdata as per Microchip support ticket #00730936 

;********************************************************************************

;********************************************************************************
;Explicit CONFIG
 CONFIG CLKOUTEN=OFF                             ;C1 Reverselookup CLKOUTEN = OFF
 CONFIG RSTOSC=HFINTOSC_32MHz                    ;C1 Reverselookup RSTOSC = HFINTOSC_32MHZ
 CONFIG FEXTOSC=OFF                              ;C1 Reverselookup FEXTOSC = OFF
 CONFIG WDTE=OFF                                 ;C1 Reverselookup WDTE = OFF
 CONFIG MCLRE=INTMCLR                            ;C1 Reverselookup MCLRE = INTMCLR
 CONFIG LVP=OFF                                  ;C1 Reverselookup LVP = OFF
 CONFIG WRTSAF=OFF                               ;C1 Reverselookup WRTSAF = OFF
 CONFIG WRTD=OFF                                 ;C1 Reverselookup WRTD = OFF
 CONFIG WRTB=OFF                                 ;C1 Reverselookup WRTB = OFF
 CONFIG CPD=OFF                                  ;C1 Reverselookup CPD = OFF
 CONFIG CP=OFF                                   ;C1 Reverselookup CP = OFF
;Inferred CONFIG


;********************************************************************************
; The XC8 xc.inc include file.  This MUST be placed after the CONFIG statements.

 #include <xc.inc>

;********************************************************************************

;Set aside RAM memory locations for variables. All variables are global.
 CCPCONCACHE                      EQU 32          ; 0X20
 DELAYTEMP                        EQU 112          ; 0X70
 DELAYTEMP2                       EQU 113          ; 0X71
 MYDUTY                           EQU 33          ; 0X21
 MYFREQUENCY                      EQU 34          ; 0X22
 PRX_TEMP                         EQU 35          ; 0X23
 PRX_TEMP_CACHE                   EQU 39          ; 0X27
 PRX_TEMP_CACHE_E                 EQU 42          ; 0X2A
 PRX_TEMP_CACHE_H                 EQU 40          ; 0X28
 PRX_TEMP_CACHE_U                 EQU 41          ; 0X29
 PRX_TEMP_E                       EQU 38          ; 0X26
 PRX_TEMP_H                       EQU 36          ; 0X24
 PRX_TEMP_U                       EQU 37          ; 0X25
 PWMCHANNEL                       EQU 43          ; 0X2B
 PWMDUTY                          EQU 44          ; 0X2C
 PWMDUTY_H                        EQU 45          ; 0X2D
 PWMFREQ                          EQU 46          ; 0X2E
 PWMFREQ_H                        EQU 47          ; 0X2F
 PWMRESOLUTION                    EQU 48          ; 0X30
 PWMRESOLUTION_H                  EQU 49          ; 0X31
 SYSBYTETEMPX                     EQU 112          ; 0X70
 SYSDIVLOOP                       EQU 116          ; 0X74
 SYSDIVMULTA                      EQU 119          ; 0X77
 SYSDIVMULTA_H                    EQU 120          ; 0X78
 SYSFORLOOPSTEP1                  EQU 50          ; 0X32
 SYSFORLOOPSTEP1_H                EQU 51          ; 0X33
 SYSINTEGERTEMPA                  EQU 117          ; 0X75
 SYSINTEGERTEMPA_H                EQU 118          ; 0X76
 SYSINTEGERTEMPB                  EQU 121          ; 0X79
 SYSINTEGERTEMPB_H                EQU 122          ; 0X7A
 SYSLONGDIVMULTA                  EQU 52          ; 0X34
 SYSLONGDIVMULTA_E                EQU 55          ; 0X37
 SYSLONGDIVMULTA_H                EQU 53          ; 0X35
 SYSLONGDIVMULTA_U                EQU 54          ; 0X36
 SYSLONGDIVMULTB                  EQU 56          ; 0X38
 SYSLONGDIVMULTB_E                EQU 59          ; 0X3B
 SYSLONGDIVMULTB_H                EQU 57          ; 0X39
 SYSLONGDIVMULTB_U                EQU 58          ; 0X3A
 SYSLONGDIVMULTX                  EQU 60          ; 0X3C
 SYSLONGDIVMULTX_E                EQU 63          ; 0X3F
 SYSLONGDIVMULTX_H                EQU 61          ; 0X3D
 SYSLONGDIVMULTX_U                EQU 62          ; 0X3E
 SYSLONGTEMPA                     EQU 117          ; 0X75
 SYSLONGTEMPA_E                   EQU 120          ; 0X78
 SYSLONGTEMPA_H                   EQU 118          ; 0X76
 SYSLONGTEMPA_U                   EQU 119          ; 0X77
 SYSLONGTEMPB                     EQU 121          ; 0X79
 SYSLONGTEMPB_E                   EQU 124          ; 0X7C
 SYSLONGTEMPB_H                   EQU 122          ; 0X7A
 SYSLONGTEMPB_U                   EQU 123          ; 0X7B
 SYSLONGTEMPX                     EQU 112          ; 0X70
 SYSLONGTEMPX_E                   EQU 115          ; 0X73
 SYSLONGTEMPX_H                   EQU 113          ; 0X71
 SYSLONGTEMPX_U                   EQU 114          ; 0X72
 SYSREPEATTEMP1                   EQU 64          ; 0X40
 SYSTEMP1                         EQU 65          ; 0X41
 SYSTEMP1_E                       EQU 68          ; 0X44
 SYSTEMP1_H                       EQU 66          ; 0X42
 SYSTEMP1_U                       EQU 67          ; 0X43
 SYSTEMP2                         EQU 69          ; 0X45
 SYSTEMP2_H                       EQU 70          ; 0X46
 SYSTEMP3                         EQU 71          ; 0X47
 SYSWAITTEMPMS                    EQU 114          ; 0X72
 SYSWAITTEMPMS_H                  EQU 115          ; 0X73
 TIMERSELECTIONBITS               EQU 72          ; 0X48
 TX_PR                            EQU 73          ; 0X49
 _PWMTIMERSELECTED                EQU 74          ; 0X4A

;********************************************************************************

 PSECT   PROGMEM0,delta=2, abs
 RESETVEC:
;VECTORS
	ORG	0
	PAGESEL	BASPROGRAMSTART
	GOTO	BASPROGRAMSTART
	ORG	4
	RETFIE

;********************************************************************************

;START OF PROGRAM MEMORY PAGE 0
	ORG	5
BASPROGRAMSTART:
;CALL INITIALISATION ROUTINES
	CALL	INITSYS
	CALL	INITPPS
	CALL	INITPWM

;START OF THE MAIN PROGRAM
	BCF	TRISB,1
	BCF	TRISB,2
	BCF	TRISB,3
	BCF	TRISB,4
	BSF	TRISA,0
	BSF	TRISB,5
	MOVLW	80
	MOVWF	MYFREQUENCY
	MOVLW	50
	MOVWF	MYDUTY
SYSDOLOOP_S1:
	MOVLW	255
	MOVWF	MYDUTY
SYSFORLOOP1:
	INCF	MYDUTY,F
	MOVLW	10
	MOVWF	SYSWAITTEMPMS
	CLRF	SYSWAITTEMPMS_H
	CALL	DELAY_MS
	MOVLW	4
	MOVWF	PWMCHANNEL
	MOVF	MYFREQUENCY,W
	MOVWF	PWMFREQ
	CLRF	PWMFREQ_H
	MOVF	MYDUTY,W
	MOVWF	PWMDUTY
	CLRF	PWMDUTY_H
	MOVLW	2
	MOVWF	_PWMTIMERSELECTED
	MOVLW	255
	MOVWF	PWMRESOLUTION
	CLRF	PWMRESOLUTION_H
	CALL	HPWM26
	MOVLW	3
	MOVWF	PWMCHANNEL
	MOVF	MYFREQUENCY,W
	MOVWF	PWMFREQ
	CLRF	PWMFREQ_H
	MOVF	MYDUTY,W
	SUBLW	255
	MOVWF	PWMDUTY
	CLRF	PWMDUTY_H
	BTFSS	STATUS,0
	DECF	PWMDUTY_H,F
	MOVLW	2
	MOVWF	_PWMTIMERSELECTED
	MOVLW	255
	MOVWF	PWMRESOLUTION
	CLRF	PWMRESOLUTION_H
	CALL	HPWM26
	MOVLW	255
	SUBWF	MYDUTY,W
	BTFSS	STATUS,0
	GOTO	SYSFORLOOP1
SYSFORLOOPEND1:
	MOVLW	254
	MOVWF	MYDUTY
SYSFORLOOP2:
;INIT SYSFORLOOPSTEP1 :#0
	MOVLW	255
	MOVWF	SYSFORLOOPSTEP1
	MOVWF	SYSFORLOOPSTEP1_H
	MOVLW	10
	MOVWF	SYSWAITTEMPMS
	CLRF	SYSWAITTEMPMS_H
	CALL	DELAY_MS
	MOVLW	4
	MOVWF	PWMCHANNEL
	MOVF	MYFREQUENCY,W
	MOVWF	PWMFREQ
	CLRF	PWMFREQ_H
	MOVF	MYDUTY,W
	MOVWF	PWMDUTY
	CLRF	PWMDUTY_H
	MOVLW	2
	MOVWF	_PWMTIMERSELECTED
	MOVLW	255
	MOVWF	PWMRESOLUTION
	CLRF	PWMRESOLUTION_H
	CALL	HPWM26
	MOVLW	3
	MOVWF	PWMCHANNEL
	MOVF	MYFREQUENCY,W
	MOVWF	PWMFREQ
	CLRF	PWMFREQ_H
	MOVF	MYDUTY,W
	SUBLW	255
	MOVWF	PWMDUTY
	CLRF	PWMDUTY_H
	BTFSS	STATUS,0
	DECF	PWMDUTY_H,F
	MOVLW	2
	MOVWF	_PWMTIMERSELECTED
	MOVLW	255
	MOVWF	PWMRESOLUTION
	CLRF	PWMRESOLUTION_H
	CALL	HPWM26
	BTFSS	SYSFORLOOPSTEP1_H,7
	GOTO	ELSE2_1
	DECF	MYDUTY,W
	MOVWF	SYSTEMP1
	COMF	SYSFORLOOPSTEP1,W
	MOVWF	SYSTEMP2
	COMF	SYSFORLOOPSTEP1_H,W
	MOVWF	SYSTEMP2_H
	INCF	SYSTEMP2,F
	BTFSC	STATUS,2
	INCF	SYSTEMP2_H,F
	MOVF	SYSTEMP1,W
	MOVWF	SYSINTEGERTEMPA
	CLRF	SYSINTEGERTEMPA_H
	MOVF	SYSTEMP2,W
	MOVWF	SYSINTEGERTEMPB
	MOVF	SYSTEMP2_H,W
	MOVWF	SYSINTEGERTEMPB_H
	CALL	SYSCOMPLESSTHANINT
	COMF	SYSBYTETEMPX,F
	BTFSS	SYSBYTETEMPX,0
	GOTO	ENDIF3
	MOVF	SYSFORLOOPSTEP1,W
	ADDWF	MYDUTY,F
	GOTO	SYSFORLOOP2
ENDIF3:
	GOTO	ENDIF2
ELSE2_1:
	MOVF	MYDUTY,W
	SUBLW	1
	MOVWF	SYSTEMP1
	MOVWF	SYSINTEGERTEMPA
	CLRF	SYSINTEGERTEMPA_H
	MOVF	SYSFORLOOPSTEP1,W
	MOVWF	SYSINTEGERTEMPB
	MOVF	SYSFORLOOPSTEP1_H,W
	MOVWF	SYSINTEGERTEMPB_H
	CALL	SYSCOMPLESSTHANINT
	COMF	SYSBYTETEMPX,F
	BTFSS	SYSBYTETEMPX,0
	GOTO	ENDIF4
	MOVF	SYSFORLOOPSTEP1,W
	ADDWF	MYDUTY,F
	GOTO	SYSFORLOOP2
ENDIF4:
ENDIF2:
SYSFORLOOPEND2:
	GOTO	SYSDOLOOP_S1
SYSDOLOOP_E1:
	GOTO	BASPROGRAMEND
BASPROGRAMEND:
	SLEEP
	GOTO	BASPROGRAMEND

;********************************************************************************

CALCULATEDUTY:
	MOVLW	1
	ADDWF	PRX_TEMP,W
	MOVWF	SYSTEMP1
	MOVLW	0
	ADDWFC	PRX_TEMP_H,W
	MOVWF	SYSTEMP1_H
	MOVLW	0
	ADDWFC	PRX_TEMP_U,W
	MOVWF	SYSTEMP1_U
	MOVLW	0
	ADDWFC	PRX_TEMP_E,W
	MOVWF	SYSTEMP1_E
	MOVF	PWMDUTY,W
	MOVWF	SYSLONGTEMPA
	MOVF	PWMDUTY_H,W
	MOVWF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	MOVF	SYSTEMP1,W
	MOVWF	SYSLONGTEMPB
	MOVF	SYSTEMP1_H,W
	MOVWF	SYSLONGTEMPB_H
	MOVF	SYSTEMP1_U,W
	MOVWF	SYSLONGTEMPB_U
	MOVF	SYSTEMP1_E,W
	MOVWF	SYSLONGTEMPB_E
	CALL	SYSMULTSUB32
	MOVF	SYSLONGTEMPX,W
	MOVWF	PRX_TEMP
	MOVF	SYSLONGTEMPX_H,W
	MOVWF	PRX_TEMP_H
	MOVF	SYSLONGTEMPX_U,W
	MOVWF	PRX_TEMP_U
	MOVF	SYSLONGTEMPX_E,W
	MOVWF	PRX_TEMP_E
	BCF	STATUS,0
	MOVLW	2
	MOVWF	SYSREPEATTEMP1
SYSREPEATLOOP1:
	RLF	PRX_TEMP,F
	RLF	PRX_TEMP_H,F
	RLF	PRX_TEMP_U,F
	RLF	PRX_TEMP_E,F
	DECFSZ	SYSREPEATTEMP1,F
	GOTO	SYSREPEATLOOP1
SYSREPEATLOOPEND1:
	MOVF	PRX_TEMP,W
	MOVWF	SYSLONGTEMPA
	MOVF	PRX_TEMP_H,W
	MOVWF	SYSLONGTEMPA_H
	MOVF	PRX_TEMP_U,W
	MOVWF	SYSLONGTEMPA_U
	MOVF	PRX_TEMP_E,W
	MOVWF	SYSLONGTEMPA_E
	MOVF	PWMRESOLUTION,W
	MOVWF	SYSLONGTEMPB
	MOVF	PWMRESOLUTION_H,W
	MOVWF	SYSLONGTEMPB_H
	CLRF	SYSLONGTEMPB_U
	CLRF	SYSLONGTEMPB_E
	CALL	SYSDIVSUB32
	MOVF	SYSLONGTEMPA,W
	MOVWF	PRX_TEMP
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	PRX_TEMP_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	PRX_TEMP_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	PRX_TEMP_E
	BCF	STATUS,0
	MOVLW	6
	MOVWF	SYSREPEATTEMP1
SYSREPEATLOOP2:
	RLF	PRX_TEMP,F
	RLF	PRX_TEMP_H,F
	RLF	PRX_TEMP_U,F
	RLF	PRX_TEMP_E,F
	DECFSZ	SYSREPEATTEMP1,F
	GOTO	SYSREPEATLOOP2
SYSREPEATLOOPEND2:
	RETURN

;********************************************************************************

DELAY_MS:
	INCF	SYSWAITTEMPMS_H, F
DMS_START:
	MOVLW	108
	MOVWF	DELAYTEMP2
DMS_OUTER:
	MOVLW	11
	MOVWF	DELAYTEMP
DMS_INNER:
	DECFSZ	DELAYTEMP, F
	GOTO	DMS_INNER
	DECFSZ	DELAYTEMP2, F
	GOTO	DMS_OUTER
	DECFSZ	SYSWAITTEMPMS, F
	GOTO	DMS_START
	DECFSZ	SYSWAITTEMPMS_H, F
	GOTO	DMS_START
	RETURN

;********************************************************************************

HPWM26:
	GOTO	HPWM27

;********************************************************************************

HPWM27:
	MOVLW	160
	MOVWF	SYSLONGTEMPA
	MOVLW	15
	MOVWF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	MOVF	PWMFREQ,W
	MOVWF	SYSLONGTEMPB
	MOVF	PWMFREQ_H,W
	MOVWF	SYSLONGTEMPB_H
	CLRF	SYSLONGTEMPB_U
	CLRF	SYSLONGTEMPB_E
	CALL	SYSDIVSUB32
	MOVF	SYSLONGTEMPA,W
	MOVWF	PRX_TEMP
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	PRX_TEMP_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	PRX_TEMP_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	PRX_TEMP_E
	MOVLW	1
	MOVWF	TX_PR
	MOVF	PRX_TEMP_H,W
	SUBLW	0
	BTFSC	STATUS,0
	GOTO	ENDIF5
	MOVLW	4
	MOVWF	TX_PR
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
ENDIF5:
	MOVF	PRX_TEMP_H,W
	SUBLW	0
	BTFSC	STATUS,0
	GOTO	ENDIF6
	MOVLW	16
	MOVWF	TX_PR
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
ENDIF6:
	MOVF	PRX_TEMP_H,W
	SUBLW	0
	BTFSC	STATUS,0
	GOTO	ENDIF7
	MOVLW	64
	MOVWF	TX_PR
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
	BCF	STATUS,0
	RRF	PRX_TEMP_E,F
	RRF	PRX_TEMP_U,F
	RRF	PRX_TEMP_H,F
	RRF	PRX_TEMP,F
ENDIF7:
SYSSELECT1CASE1:
	MOVLW	2
	SUBWF	_PWMTIMERSELECTED,W
	BTFSS	STATUS,2
	GOTO	SYSSELECT1CASE2
	MOVF	PRX_TEMP,W
	BANKSEL	T2PR
	MOVWF	T2PR
	MOVLW	1
	MOVWF	T2CLKCON
	CLRF	T2HLT
	CLRF	T2RST
	CLRF	T2TMR
	BCF	T2CON,4
	BCF	T2CON,5
	BCF	T2CON,6
	MOVLW	4
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF8
	BANKSEL	T2CON
	BSF	T2CON,5
ENDIF8:
	MOVLW	16
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF9
	BANKSEL	T2CON
	BSF	T2CON,6
ENDIF9:
	MOVLW	64
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF10
	BANKSEL	T2CON
	BSF	T2CON,6
	BSF	T2CON,5
ENDIF10:
	BANKSEL	PIR1
	BCF	PIR1,7
	BANKSEL	T2CON
	BSF	T2CON,7
	GOTO	SYSSELECTEND1
SYSSELECT1CASE2:
	MOVLW	4
	SUBWF	_PWMTIMERSELECTED,W
	BTFSS	STATUS,2
	GOTO	SYSSELECT1CASE3
	MOVF	PRX_TEMP,W
	BANKSEL	T4PR
	MOVWF	T4PR
	MOVLW	1
	MOVWF	T4CLKCON
	CLRF	T4HLT
	CLRF	T4RST
	CLRF	T4TMR
	BCF	T4CON,4
	BCF	T4CON,5
	BCF	T4CON,6
	MOVLW	4
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF11
	BANKSEL	T4CON
	BSF	T4CON,5
ENDIF11:
	MOVLW	16
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF12
	BANKSEL	T4CON
	BSF	T4CON,6
ENDIF12:
	MOVLW	64
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF13
	BANKSEL	T4CON
	BSF	T4CON,6
	BSF	T4CON,5
ENDIF13:
	BANKSEL	PIR2
	BCF	PIR2,0
	BANKSEL	T4CON
	BSF	T4CON,7
	GOTO	SYSSELECTEND1
SYSSELECT1CASE3:
	MOVLW	6
	SUBWF	_PWMTIMERSELECTED,W
	BTFSS	STATUS,2
	GOTO	SYSSELECTEND1
	MOVF	PRX_TEMP,W
	BANKSEL	T6PR
	MOVWF	T6PR
	MOVLW	1
	MOVWF	T6CLKCON
	CLRF	T6HLT
	CLRF	T6RST
	CLRF	T6TMR
	BCF	T6CON,4
	BCF	T6CON,5
	BCF	T6CON,6
	MOVLW	4
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF14
	BANKSEL	T6CON
	BSF	T6CON,5
ENDIF14:
	MOVLW	16
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF15
	BANKSEL	T6CON
	BSF	T6CON,6
ENDIF15:
	MOVLW	64
	BANKSEL	TX_PR
	SUBWF	TX_PR,W
	BTFSS	STATUS,2
	GOTO	ENDIF16
	BANKSEL	T6CON
	BSF	T6CON,6
	BSF	T6CON,5
ENDIF16:
	BANKSEL	PIR2
	BCF	PIR2,1
	BANKSEL	T6CON
	BSF	T6CON,7
SYSSELECTEND1:
TENBITPMWSECTION:
	BANKSEL	PRX_TEMP
	MOVF	PRX_TEMP,W
	MOVWF	PRX_TEMP_CACHE
	MOVF	PRX_TEMP_H,W
	MOVWF	PRX_TEMP_CACHE_H
	MOVF	PRX_TEMP_U,W
	MOVWF	PRX_TEMP_CACHE_U
	MOVF	PRX_TEMP_E,W
	MOVWF	PRX_TEMP_CACHE_E
	MOVLW	3
	SUBWF	PWMCHANNEL,W
	BTFSS	STATUS,2
	GOTO	ENDIF17
	CALL	CALCULATEDUTY
	MOVF	PRX_TEMP_H,W
	BANKSEL	PWM3DCH
	MOVWF	PWM3DCH
	BANKSEL	PRX_TEMP
	MOVF	PRX_TEMP,W
	BANKSEL	PWM3DCL
	MOVWF	PWM3DCL
	BCF	STATUS,0
	BANKSEL	_PWMTIMERSELECTED
	RRF	_PWMTIMERSELECTED,W
	MOVWF	TIMERSELECTIONBITS
	BANKSEL	PWM3CON
	BSF	PWM3CON,7
ENDIF17:
	MOVLW	4
	BANKSEL	PWMCHANNEL
	SUBWF	PWMCHANNEL,W
	BTFSS	STATUS,2
	GOTO	ENDIF18
	CALL	CALCULATEDUTY
	MOVF	PRX_TEMP_H,W
	BANKSEL	PWM4DCH
	MOVWF	PWM4DCH
	BANKSEL	PRX_TEMP
	MOVF	PRX_TEMP,W
	BANKSEL	PWM4DCL
	MOVWF	PWM4DCL
	BCF	STATUS,0
	BANKSEL	_PWMTIMERSELECTED
	RRF	_PWMTIMERSELECTED,W
	MOVWF	TIMERSELECTIONBITS
	BANKSEL	PWM4CON
	BSF	PWM4CON,7
ENDIF18:
	MOVLW	5
	BANKSEL	PWMCHANNEL
	SUBWF	PWMCHANNEL,W
	BTFSS	STATUS,2
	GOTO	ENDIF19
	CALL	CALCULATEDUTY
	MOVF	PRX_TEMP_H,W
	BANKSEL	PWM5DCH
	MOVWF	PWM5DCH
	BANKSEL	PRX_TEMP
	MOVF	PRX_TEMP,W
	BANKSEL	PWM5DCL
	MOVWF	PWM5DCL
	BSF	PWM5CON,7
ENDIF19:
	BANKSEL	STATUS
	RETURN

;********************************************************************************

INITPPS:
	MOVLW	12
	BANKSEL	RB2PPS
	MOVWF	RB2PPS
	MOVLW	11
	MOVWF	RB1PPS
	BANKSEL	STATUS
	RETURN

;********************************************************************************

INITPWM:
	MOVLW	2
	MOVWF	_PWMTIMERSELECTED
LEGACY_STARTOFFIXEDCCPPWMMODECODE:
	CLRF	CCPCONCACHE
	MOVLW	105
	BANKSEL	T2PR
	MOVWF	T2PR
	BCF	T2CON,4
	BCF	T2CON,5
	BCF	T2CON,6
	BANKSEL	CCPCONCACHE
	BSF	CCPCONCACHE,4
	MOVLW	53
	BANKSEL	CCPR1H
	MOVWF	CCPR1H
	CLRF	CCPR1L
	MOVLW	1
	BANKSEL	T2CLKCON
	MOVWF	T2CLKCON
	BANKSEL	CCPCONCACHE
	BSF	CCPCONCACHE,7
	BSF	CCPCONCACHE,3
	BSF	CCPCONCACHE,2
	BCF	CCPCONCACHE,1
	BCF	CCPCONCACHE,0
	BANKSEL	T2CON
	BSF	T2CON,7
STARTOFFIXEDPWMMODECODE:
SETPWMDUTYCODE:
REV2018_ENDOFFIXEDPWMMODECODE:
	BANKSEL	STATUS
	RETURN

;********************************************************************************

INITSYS:
;asm showdebug This code block sets the internal oscillator to ChipMHz
	BANKSEL	OSCCON2
	CLRF	OSCCON2
	CLRF	OSCCON3
	MOVLW	4
	MOVWF	OSCFRQ
;asm showdebug _Complete_the_chip_setup_of_BSR,ADCs,ANSEL_and_other_key_setup_registers_or_register_bits
	BANKSEL	ADCON0
	BCF	ADCON0,2
	BCF	ADCON0,7
	BANKSEL	ANSELA
	CLRF	ANSELA
	CLRF	ANSELB
	CLRF	ANSELC
	CLRF	ANSELD
	CLRF	ANSELE
	BANKSEL	CM1CON0
	BCF	CM1CON0,7
	BANKSEL	PORTA
	CLRF	PORTA
	CLRF	PORTB
	CLRF	PORTC
	CLRF	PORTD
	CLRF	PORTE
	RETURN

;********************************************************************************

SYSCOMPEQUAL32:
	CLRF	SYSBYTETEMPX
	MOVF	SYSLONGTEMPA, W
	SUBWF	SYSLONGTEMPB, W
	BTFSS	STATUS,2
	RETURN
	MOVF	SYSLONGTEMPA_H, W
	SUBWF	SYSLONGTEMPB_H, W
	BTFSS	STATUS,2
	RETURN
	MOVF	SYSLONGTEMPA_U, W
	SUBWF	SYSLONGTEMPB_U, W
	BTFSS	STATUS,2
	RETURN
	MOVF	SYSLONGTEMPA_E, W
	SUBWF	SYSLONGTEMPB_E, W
	BTFSS	STATUS,2
	RETURN
	COMF	SYSBYTETEMPX,F
	RETURN

;********************************************************************************

SYSCOMPLESSTHAN32:
	CLRF	SYSBYTETEMPX
	MOVF	SYSLONGTEMPA_E,W
	SUBWF	SYSLONGTEMPB_E,W
	BTFSS	STATUS,0
	RETURN
	BTFSS	STATUS,2
	GOTO	SCLT32TRUE
	MOVF	SYSLONGTEMPA_U,W
	SUBWF	SYSLONGTEMPB_U,W
	BTFSS	STATUS,0
	RETURN
	BTFSS	STATUS,2
	GOTO	SCLT32TRUE
	MOVF	SYSLONGTEMPA_H,W
	SUBWF	SYSLONGTEMPB_H,W
	BTFSS	STATUS,0
	RETURN
	BTFSS	STATUS,2
	GOTO	SCLT32TRUE
	MOVF	SYSLONGTEMPB,W
	SUBWF	SYSLONGTEMPA,W
	BTFSC	STATUS,0
	RETURN
SCLT32TRUE:
	COMF	SYSBYTETEMPX,F
	RETURN

;********************************************************************************

SYSCOMPLESSTHANINT:
	CLRF	SYSBYTETEMPX
	BTFSS	SYSINTEGERTEMPA_H,7
	GOTO	ELSE24_1
	BTFSC	SYSINTEGERTEMPB_H,7
	GOTO	ENDIF25
	COMF	SYSBYTETEMPX,F
	RETURN
ENDIF25:
	COMF	SYSINTEGERTEMPA,W
	MOVWF	SYSDIVMULTA
	COMF	SYSINTEGERTEMPA_H,W
	MOVWF	SYSDIVMULTA_H
	INCF	SYSDIVMULTA,F
	BTFSC	STATUS,2
	INCF	SYSDIVMULTA_H,F
	COMF	SYSINTEGERTEMPB,W
	MOVWF	SYSINTEGERTEMPA
	COMF	SYSINTEGERTEMPB_H,W
	MOVWF	SYSINTEGERTEMPA_H
	INCF	SYSINTEGERTEMPA,F
	BTFSC	STATUS,2
	INCF	SYSINTEGERTEMPA_H,F
	MOVF	SYSDIVMULTA,W
	MOVWF	SYSINTEGERTEMPB
	MOVF	SYSDIVMULTA_H,W
	MOVWF	SYSINTEGERTEMPB_H
	GOTO	ENDIF24
ELSE24_1:
	BTFSC	SYSINTEGERTEMPB_H,7
	RETURN
ENDIF24:
	MOVF	SYSINTEGERTEMPA_H,W
	SUBWF	SYSINTEGERTEMPB_H,W
	BTFSS	STATUS,0
	RETURN
	MOVF	SYSINTEGERTEMPB_H,W
	SUBWF	SYSINTEGERTEMPA_H,W
	BTFSS	STATUS,0
	GOTO	SCLTINTTRUE
	MOVF	SYSINTEGERTEMPB,W
	SUBWF	SYSINTEGERTEMPA,W
	BTFSC	STATUS,0
	RETURN
SCLTINTTRUE:
	COMF	SYSBYTETEMPX,F
	RETURN

;********************************************************************************

SYSDIVSUB32:
	MOVF	SYSLONGTEMPA,W
	MOVWF	SYSLONGDIVMULTA
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	SYSLONGDIVMULTA_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	SYSLONGDIVMULTA_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	SYSLONGDIVMULTA_E
	MOVF	SYSLONGTEMPB,W
	MOVWF	SYSLONGDIVMULTB
	MOVF	SYSLONGTEMPB_H,W
	MOVWF	SYSLONGDIVMULTB_H
	MOVF	SYSLONGTEMPB_U,W
	MOVWF	SYSLONGDIVMULTB_U
	MOVF	SYSLONGTEMPB_E,W
	MOVWF	SYSLONGDIVMULTB_E
	CLRF	SYSLONGDIVMULTX
	CLRF	SYSLONGDIVMULTX_H
	CLRF	SYSLONGDIVMULTX_U
	CLRF	SYSLONGDIVMULTX_E
	MOVF	SYSLONGDIVMULTB,W
	MOVWF	SYSLONGTEMPA
	MOVF	SYSLONGDIVMULTB_H,W
	MOVWF	SYSLONGTEMPA_H
	MOVF	SYSLONGDIVMULTB_U,W
	MOVWF	SYSLONGTEMPA_U
	MOVF	SYSLONGDIVMULTB_E,W
	MOVWF	SYSLONGTEMPA_E
	CLRF	SYSLONGTEMPB
	CLRF	SYSLONGTEMPB_H
	CLRF	SYSLONGTEMPB_U
	CLRF	SYSLONGTEMPB_E
	CALL	SYSCOMPEQUAL32
	BTFSS	SYSBYTETEMPX,0
	GOTO	ENDIF22
	CLRF	SYSLONGTEMPA
	CLRF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	RETURN
ENDIF22:
	MOVLW	32
	MOVWF	SYSDIVLOOP
SYSDIV32START:
	BCF	STATUS,0
	RLF	SYSLONGDIVMULTA,F
	RLF	SYSLONGDIVMULTA_H,F
	RLF	SYSLONGDIVMULTA_U,F
	RLF	SYSLONGDIVMULTA_E,F
	RLF	SYSLONGDIVMULTX,F
	RLF	SYSLONGDIVMULTX_H,F
	RLF	SYSLONGDIVMULTX_U,F
	RLF	SYSLONGDIVMULTX_E,F
	MOVF	SYSLONGDIVMULTB,W
	SUBWF	SYSLONGDIVMULTX,F
	MOVF	SYSLONGDIVMULTB_H,W
	SUBWFB	SYSLONGDIVMULTX_H,F
	MOVF	SYSLONGDIVMULTB_U,W
	SUBWFB	SYSLONGDIVMULTX_U,F
	MOVF	SYSLONGDIVMULTB_E,W
	SUBWFB	SYSLONGDIVMULTX_E,F
	BSF	SYSLONGDIVMULTA,0
	BTFSC	STATUS,0
	GOTO	ENDIF23
	BCF	SYSLONGDIVMULTA,0
	MOVF	SYSLONGDIVMULTB,W
	ADDWF	SYSLONGDIVMULTX,F
	MOVF	SYSLONGDIVMULTB_H,W
	ADDWFC	SYSLONGDIVMULTX_H,F
	MOVF	SYSLONGDIVMULTB_U,W
	ADDWFC	SYSLONGDIVMULTX_U,F
	MOVF	SYSLONGDIVMULTB_E,W
	ADDWFC	SYSLONGDIVMULTX_E,F
ENDIF23:
	DECFSZ	SYSDIVLOOP, F
	GOTO	SYSDIV32START
	MOVF	SYSLONGDIVMULTA,W
	MOVWF	SYSLONGTEMPA
	MOVF	SYSLONGDIVMULTA_H,W
	MOVWF	SYSLONGTEMPA_H
	MOVF	SYSLONGDIVMULTA_U,W
	MOVWF	SYSLONGTEMPA_U
	MOVF	SYSLONGDIVMULTA_E,W
	MOVWF	SYSLONGTEMPA_E
	MOVF	SYSLONGDIVMULTX,W
	MOVWF	SYSLONGTEMPX
	MOVF	SYSLONGDIVMULTX_H,W
	MOVWF	SYSLONGTEMPX_H
	MOVF	SYSLONGDIVMULTX_U,W
	MOVWF	SYSLONGTEMPX_U
	MOVF	SYSLONGDIVMULTX_E,W
	MOVWF	SYSLONGTEMPX_E
	RETURN

;********************************************************************************

SYSMULTSUB32:
	MOVF	SYSLONGTEMPA,W
	MOVWF	SYSLONGDIVMULTA
	MOVF	SYSLONGTEMPA_H,W
	MOVWF	SYSLONGDIVMULTA_H
	MOVF	SYSLONGTEMPA_U,W
	MOVWF	SYSLONGDIVMULTA_U
	MOVF	SYSLONGTEMPA_E,W
	MOVWF	SYSLONGDIVMULTA_E
	MOVF	SYSLONGTEMPB,W
	MOVWF	SYSLONGDIVMULTB
	MOVF	SYSLONGTEMPB_H,W
	MOVWF	SYSLONGDIVMULTB_H
	MOVF	SYSLONGTEMPB_U,W
	MOVWF	SYSLONGDIVMULTB_U
	MOVF	SYSLONGTEMPB_E,W
	MOVWF	SYSLONGDIVMULTB_E
	CLRF	SYSLONGDIVMULTX
	CLRF	SYSLONGDIVMULTX_H
	CLRF	SYSLONGDIVMULTX_U
	CLRF	SYSLONGDIVMULTX_E
MUL32LOOP:
	BTFSS	SYSLONGDIVMULTB,0
	GOTO	ENDIF20
	MOVF	SYSLONGDIVMULTA,W
	ADDWF	SYSLONGDIVMULTX,F
	MOVF	SYSLONGDIVMULTA_H,W
	ADDWFC	SYSLONGDIVMULTX_H,F
	MOVF	SYSLONGDIVMULTA_U,W
	ADDWFC	SYSLONGDIVMULTX_U,F
	MOVF	SYSLONGDIVMULTA_E,W
	ADDWFC	SYSLONGDIVMULTX_E,F
ENDIF20:
	BCF	STATUS,0
	RRF	SYSLONGDIVMULTB_E,F
	RRF	SYSLONGDIVMULTB_U,F
	RRF	SYSLONGDIVMULTB_H,F
	RRF	SYSLONGDIVMULTB,F
	BCF	STATUS,0
	RLF	SYSLONGDIVMULTA,F
	RLF	SYSLONGDIVMULTA_H,F
	RLF	SYSLONGDIVMULTA_U,F
	RLF	SYSLONGDIVMULTA_E,F
	MOVF	SYSLONGDIVMULTB,W
	MOVWF	SYSLONGTEMPB
	MOVF	SYSLONGDIVMULTB_H,W
	MOVWF	SYSLONGTEMPB_H
	MOVF	SYSLONGDIVMULTB_U,W
	MOVWF	SYSLONGTEMPB_U
	MOVF	SYSLONGDIVMULTB_E,W
	MOVWF	SYSLONGTEMPB_E
	CLRF	SYSLONGTEMPA
	CLRF	SYSLONGTEMPA_H
	CLRF	SYSLONGTEMPA_U
	CLRF	SYSLONGTEMPA_E
	CALL	SYSCOMPLESSTHAN32
	BTFSC	SYSBYTETEMPX,0
	GOTO	MUL32LOOP
	MOVF	SYSLONGDIVMULTX,W
	MOVWF	SYSLONGTEMPX
	MOVF	SYSLONGDIVMULTX_H,W
	MOVWF	SYSLONGTEMPX_H
	MOVF	SYSLONGDIVMULTX_U,W
	MOVWF	SYSLONGTEMPX_U
	MOVF	SYSLONGDIVMULTX_E,W
	MOVWF	SYSLONGTEMPX_E
	RETURN

;********************************************************************************

;START OF PROGRAM MEMORY PAGE 1
	PSECT	PROGMEM1,CLASS=CODE,SPACE=SPACE_CODE,DELTA=2, ABS, OVRLD 
	ORG	2048
;START OF PROGRAM MEMORY PAGE 2
	PSECT	PROGMEM2,CLASS=CODE,SPACE=SPACE_CODE,DELTA=2, ABS, OVRLD 
	ORG	4096
;START OF PROGRAM MEMORY PAGE 3
	PSECT	PROGMEM3,CLASS=CODE,SPACE=SPACE_CODE,DELTA=2, ABS, OVRLD 
	ORG	6144
;
; Declare Power-On-Reset entry point
;
 END     RESETVEC
